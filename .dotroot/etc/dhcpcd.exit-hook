#!/usr/bin/env bash

case "$reason" in BOUND6|RENEW6|REBIND6|REBOOT6|DELEGATED6)
    if [[ "$interface" = extern0 ]]; then
      ip route add default via $(ip -6 route list dev extern0 default | grep -oP 'via \K[0-9a-f:]*') dev intern0
    elif [[ "$interface" = intern0 ]]; then
      ip6="${new_delegated_dhcp6_prefix::-3}"
      if ! grep -q "$ip6" /etc/radvd.conf; then
        sed -i "s/RDNSS .* /RDNSS ${ip6} /" /etc/radvd.conf
	systemctl restart radvd
      fi
    fi
    ;;
esac
